# P6课下
1. **好的架构很重要，好笔头很重要**

**BUG梳理**
1. `ADDI` 指令的立即数没有符号扩展，导致负数立即数无法正确处理。
   + 需要仔细阅读RTL语言
   + 症状： 测试点报 0000xxxx，预期 ffffxxxx。
   + 原因： ADDI 指令的立即数本应进行符号扩展 (EXT_SIGN)，但 Controller 中误写为零扩展 (EXT_ZERO)，导致所有负数被错误地视为正数。
2. 添加新指令三个环节：
   1. Controller + Constants
   2. Datapath
   3. DE_REG.v 中 tnew 的更新(忘记了MFHI/MFLO)
3. 访存数据要对齐：
   + 症状： sb/sh 写入非对齐地址时，内存写入了 0x00 而非预期数据。
   + 原因： Testbench 严格按字节车道 (wdata[31:24], etc.) 取数据 。M_BE 模块缺失了将寄存器中的数据（位于 WD[7:0]）复制到所有高位通道的逻辑，导致 Testbench 从错误的高位通道抓取了 0x00。
   + 需要复制到所有字节车道。