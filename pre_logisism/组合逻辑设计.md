# 组合逻辑设计 - 硬件的语义



## 含有逻辑门电路的设计

1. （可选）画出**真值表**
2. 列出输出与输入之间的**布尔表达式**（POS或与式、SOP与或式）
3. 化简表达式：定理、卡诺图、[在最后电路阶段还可以“推气泡”]
4. 根据表达式设计**逻辑电路**：输入输出各一边、拐角尽可能少。



## 组合逻辑模块

### 复用器 multiplexer（MUX）

+ 控制信号(S)，决定输出哪个输入数据。
+ 可以实现任意N输入逻辑函数，即I0-IN作为指定常量，S1-SM作为输入

![4 to 1 Multiplexer](./assets/4-to-1-multiplexer.jpg)

易错题：注意ABC分别对应的是第0、1、2位

![image-20250917215912838](./assets/image-20250917215912838.png)

### 分配器 Demultiplexer

+ 多路分配器和多路选择器功能恰好相反
+ 将 1 个输入数据，根据控制信号（S）传送到多个输出端的任何一个输出端。

![Demultiplexer](./assets/demultiplexer.jpg)

### 译码器 decoder (DEC) - 电脑内存ROM

+ 每一组输入（密码）对应唯一一个输出为1（独热）

![Block Diagram of a Decoder](./assets/block-diagram-decoder.jpg)

**复用器是多输入，单输出，输出取决于输入与选择信号，译码器则是无输入，多输出，输出模式仅取决于选择信号。**

**译码器输出位宽每个信号仅一位，多路选择器可以有多位**

# 时序逻辑设计

+ **这一组和下一组之间的关系**
+ 时钟沿
+ 复位信号：同步复位、异步复位
+ 关键路径

## 电路分析思路

1. 列出真值表
   1. 假定prev值
   2. 先分析，外部输入能直接决定输出的组合
   3. 再分析，外部输入不能直接决定输出的组合

## 双稳态电路

<img src="./assets/image-20250917085907196.png" alt="image-20250917085907196" style="zoom:50%;" />

## SR锁存器 - 控制【按按钮】

<img src="./assets/image-20250917091235417.png" alt="image-20250917091235417" style="zoom:50%;" />

+ S-set  R- reset

+ | 功能 | S    | R    | Q            | \(\overline{Q}\)        |
  | ---- | ---- | ---- | ------------ | ----------------------- |
  | 清除 | 0    | 1    | 0            | 1                       |
  | 置位 | 1    | 0    | 1            | 0                       |
  | 保持 | 0    | 0    | \(Q_{prev}\) | \(\overline{Q}_{prev}\) |
  | 非法 | 1    | 1    | 0            | 0                       |

## D 锁存器 - 数据的存储与时序

<img src="./assets/image-20250917093538800.png" alt="image-20250917093538800" style="zoom:50%;" />

+ CLK 为 0时，阻塞
+ CLK为1时，D进入锁存器。

## D触发器 - 船只通过大坝

## 有限状态机（FSM）

1. 模块分解
2. 寻找输入、输出，采用合适周期的时钟(CLK)
3. 画出状态转换图，判断用哪种状态机

Moore状态机 - **输出函数只取决于当前状态**

![State Diagram of Moore State Machine](./assets/state-diagram-of-moore-state-machine.jpg)



Mealy状态机 - **输出函数同时取决于当前状态和输入**

![State Diagram of Mealy State Machine](./assets/state-diagram.jpg)

注释：input / output

4. 画出状态转换表、输出表
   + 对于Moore机
     +  状态转换表：当前状态 | 输入 | 下一个状态
     + 输出表： 当前状态 | 输出
   + 对于Mealy机
     + 状态转换表+输出： 当前状态 | 输入 | 下一个状态 | 输出
5. 对 **状态 **选择 **二进制编码** or **独热编码**（只有一位为1）
6. 画出对状态编码后的表格 状态转化为编码（位数）
7. 写出下一个状态与输出的布尔表达式
8. 设计电路

Moore状态机 - **输出函数只取决于当前状态**



![image-20250918160856965](./assets/image-20250918160856965.png)

Mealy状态机 - **输出函数同时取决于当前状态和输入**

![image-20250918160912385](./assets/image-20250918160912385.png)

### 例题 2^n mod 5

使用 Logisim 搭建电路，该电路串行输入一个二进制无符号数 B（先从高位输入，每输入一个数字就相当于之前输入的数左移一位再加上当前输入的数字），输出 “2 的 B 次幂” 模 5 的余数的电路并提交。

- **输入**： In（1bit 串行输入）

- **输出**： S0,S1,S2,S3,S4*S*0,*S*1,*S*2,*S*3,*S*4（独热编码，当 Sx*S**x* 为 11 表示 2In≡x(mod5)2In≡*x*(mod5)）

- **文件内模块名**: mod5

- **状态机类型**: Mealy 型有限状态机

#### 解析

##### 找状态

发现$2^B \bmod 5$ 结果 以 1，2， 4 ， 3 为循环

因此状态只有四个，

| 状态S | 对应余数结果 | 独热编码 |
| ----- | ------------ | -------- |
| S0    | 1            | 01000    |
| S1    | 2            | 00100    |
| S2    | 4            | 00001    |
| S3    | 3            | 00010    |



##### 画出转移图、条件、输出图

先从高位输入，每输入一个数字就相当于之前输入的数左移一位再加上当前输入的数字 --$ new=(2×old+b)$

然后转化为求$B \mod 4$的结果

即新余数 $new=(2×old+b)\mod4$, 

输出

| 当前状态（余数） | 输入b | 下一个状态 | 输出  | 独热码输出 |
| ---------------- | ----- | ---------- | ----- | ---------- |
| S0               | 1     | S1         | 00100 |            |
| S0               | 0     | S0         | 01000 |            |
| S1               | 1     | S3         | 00010 |            |
| S1               | 0     | S2         | 00001 |            |
| S2               | 1     | S1         | 00100 |            |
| S2               | 0     | S0         | 01000 |            |
| S3               | 1     | S3         | 00010 |            |
| S3               | 0     | S2         | 00001 |            |

状态转移的布尔表达式

$q0' = \overline{b}\,\land (q0 \lor q2)$


$q1' = b\,\land (q0\lor q2)$


$q2' = \overline b\,\land (q1 \lor q3)$


$q3' = b\,\land (q1 \lor q3)$


输出表达式

O0 =  0

O1 = $\overline{b} \, \land (q0 \,\or\,q2) $

O2 = $b \, \land (q0 \,\or\,q2) $

O3 = $b \, \land (q1 \,\or\,q3) $

O1 = $\overline{b} \, \land (q1 \,\or\,q3) $